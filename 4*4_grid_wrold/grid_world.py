"""
动态规划算法通过迭代计算来评估4*4方格世界中的一个随机策略。

问题：评估在这个方格世界里给定的策略。
该问题等同于：求解该方格世界在给定策略下的（状态）价值函数，也就是求解在给定策略下，
该方格世界里每一个状态的价值。

1.状态空间 S：S_{1} - S_{14}为非终止状态；S_{0} ，S_{15} 终止状态，图中灰色方格所示两个位置；
2.行为空间 A：{n, e, s, w} 对于任何非终止状态可以有向北、东、南、西移动四个行为；
3.转移概率 P：任何试图离开方格世界的动作其位置将不会发生改变，其余条件下将100%地转移到动作指向的位置；
4.即时奖励 R：任何在非终止状态间的转移得到的即时奖励均为-1，进入终止状态即时奖励为0；
5.衰减系数 γ：1；
6.当前策略π：个体采用随机行动策略，在任何一个非终止状态下有均等的几率往任意可能的方向移动，
即π(n|•) = π(e|•) = π(s|•) = π(w|•) = 1/4。
"""

# 申明状态
states = [i for i in range(16)]

# 申明状态价值，并初始化各状态价值为0
values = [0 for _ in range(16)]

# 申明行为空间
actions = ['n', 'e', 's', 'w']

# 结合grid——world的布局特点，简易申明行为对状态的改变
ds_actions = {'n': -4, 'e': 1, 's': 4, 'w': -1}

# 申明衰减系数为1
gamma = 1.00


# 根据当前状态确定下一状态
def get_nextstate(state, action):
    next_state = state
    if (state % 4 == 0 and action == 'w') or (state < 4 and action == 'n') or (
        (state + 1) % 4 == 0 and action == 'e') or (state > 11
                                                    and action == 's'):
        pass
    else:
        current_action = ds_actions[action]
        next_state = state + current_action
    return next_state


# 计算某一状态的即时奖励
def immediate_reward(state):
    return 0 if state in [0, 15] else -1


# 判断某一状态是否为中止状态
def isFinally_state(state):
    return state in [0, 15]


# 获取当前状态的所有可能的后继状态
def get_all_nextstates(state):
    all_nextstates = []
    if isFinally_state(state):
        return all_nextstates
    for action in actions:
        next_state = get_nextstate(state, action)
        all_nextstates.append(next_state)
    return all_nextstates


# 根据后继状态的价值更新某一状态的价值
def updateValue(state):
    all_nextstates = get_all_nextstates(state)
    newValue = 0
    num = 4
    reward = immediate_reward(state)
    for next_state in all_nextstates:
        newValue += 1.00 / num * (reward + gamma * values[next_state])

    return newValue


# 一次迭代
def preform_one_iter():
    newValues = [0 for _ in range(16)]
    for state in states:
        newValues[state] = updateValue(state)
    global values
    values = newValues
    print_values(values)


# 打印函数
def print_values(values):
    for i in range(16):
        print('{0:>6.2f}'.format(values[i]), end=' ')
        if (i + 1) % 4 == 0:
            print("")
    print()


if __name__ == '__main__':
    MAX_ITERATE_STEPS = 200
    CUR_ITERATE_STEP = 0
    while CUR_ITERATE_STEP <= MAX_ITERATE_STEPS:
        print('Iterate step: %d', CUR_ITERATE_STEP)
        preform_one_iter()
        CUR_ITERATE_STEP += 1

    print("The %d iterates finally results:")
    print_values(values)
"""
# Iterate results
Iterate step: %d 36
  0.00 -12.20 -17.34 -19.02
-12.20 -15.65 -17.36 -17.34
-17.34 -17.36 -15.65 -12.20
-19.02 -17.34 -12.20   0.00

Iterate step: %d 37
  0.00 -12.30 -17.48 -19.18
-12.30 -15.78 -17.50 -17.48
-17.48 -17.50 -15.78 -12.30
-19.18 -17.48 -12.30   0.00

Iterate step: %d 38
  0.00 -12.39 -17.61 -19.33
-12.39 -15.90 -17.63 -17.61
-17.61 -17.63 -15.90 -12.39
-19.33 -17.61 -12.39   0.00

Iterate step: %d 39
  0.00 -12.47 -17.74 -19.47
-12.47 -16.01 -17.76 -17.74
-17.74 -17.76 -16.01 -12.47
-19.47 -17.74 -12.47   0.00

Iterate step: %d 40
  0.00 -12.56 -17.86 -19.61
-12.56 -16.12 -17.87 -17.86
-17.86 -17.87 -16.12 -12.56
-19.61 -17.86 -12.56   0.00

Iterate step: %d 41
  0.00 -12.63 -17.97 -19.73
-12.63 -16.22 -17.99 -17.97
-17.97 -17.99 -16.22 -12.63
-19.73 -17.97 -12.63   0.00

Iterate step: %d 42
  0.00 -12.71 -18.08 -19.85
-12.71 -16.31 -18.09 -18.08
-18.08 -18.09 -16.31 -12.71
-19.85 -18.08 -12.71   0.00

Iterate step: %d 43
  0.00 -12.77 -18.18 -19.97
-12.77 -16.40 -18.20 -18.18
-18.18 -18.20 -16.40 -12.77
-19.97 -18.18 -12.77   0.00

Iterate step: %d 44
  0.00 -12.84 -18.28 -20.08
-12.84 -16.49 -18.29 -18.28
-18.28 -18.29 -16.49 -12.84
-20.08 -18.28 -12.84   0.00

Iterate step: %d 45
  0.00 -12.90 -18.37 -20.18
-12.90 -16.57 -18.38 -18.37
-18.37 -18.38 -16.57 -12.90
-20.18 -18.37 -12.90   0.00

Iterate step: %d 46
  0.00 -12.96 -18.46 -20.28
-12.96 -16.64 -18.47 -18.46
-18.46 -18.47 -16.64 -12.96
-20.28 -18.46 -12.96   0.00

Iterate step: %d 47
  0.00 -13.02 -18.54 -20.37
-13.02 -16.71 -18.55 -18.54
-18.54 -18.55 -16.71 -13.02
-20.37 -18.54 -13.02   0.00

Iterate step: %d 48
  0.00 -13.07 -18.62 -20.45
-13.07 -16.78 -18.63 -18.62
-18.62 -18.63 -16.78 -13.07
-20.45 -18.62 -13.07   0.00

Iterate step: %d 49
  0.00 -13.12 -18.69 -20.54
-13.12 -16.85 -18.70 -18.69
-18.69 -18.70 -16.85 -13.12
-20.54 -18.69 -13.12   0.00

Iterate step: %d 50
  0.00 -13.16 -18.76 -20.61
-13.16 -16.91 -18.77 -18.76
-18.76 -18.77 -16.91 -13.16
-20.61 -18.76 -13.16   0.00

Iterate step: %d 51
  0.00 -13.21 -18.83 -20.69
-13.21 -16.97 -18.84 -18.83
-18.83 -18.84 -16.97 -13.21
-20.69 -18.83 -13.21   0.00

Iterate step: %d 52
  0.00 -13.25 -18.89 -20.76
-13.25 -17.02 -18.90 -18.89
-18.89 -18.90 -17.02 -13.25
-20.76 -18.89 -13.25   0.00

Iterate step: %d 53
  0.00 -13.29 -18.95 -20.82
-13.29 -17.07 -18.96 -18.95
-18.95 -18.96 -17.07 -13.29
-20.82 -18.95 -13.29   0.00

Iterate step: %d 54
  0.00 -13.33 -19.00 -20.89
-13.33 -17.12 -19.01 -19.00
-19.00 -19.01 -17.12 -13.33
-20.89 -19.00 -13.33   0.00

Iterate step: %d 55
  0.00 -13.36 -19.06 -20.95
-13.36 -17.17 -19.06 -19.06
-19.06 -19.06 -17.17 -13.36
-20.95 -19.06 -13.36   0.00

Iterate step: %d 56
  0.00 -13.40 -19.11 -21.00
-13.40 -17.21 -19.11 -19.11
-19.11 -19.11 -17.21 -13.40
-21.00 -19.11 -13.40   0.00

Iterate step: %d 57
  0.00 -13.43 -19.16 -21.05
-13.43 -17.26 -19.16 -19.16
-19.16 -19.16 -17.26 -13.43
-21.05 -19.16 -13.43   0.00

Iterate step: %d 58
  0.00 -13.46 -19.20 -21.10
-13.46 -17.30 -19.21 -19.20
-19.20 -19.21 -17.30 -13.46
-21.10 -19.20 -13.46   0.00

Iterate step: %d 59
  0.00 -13.49 -19.24 -21.15
-13.49 -17.33 -19.25 -19.24
-19.24 -19.25 -17.33 -13.49
-21.15 -19.24 -13.49   0.00

Iterate step: %d 60
  0.00 -13.52 -19.28 -21.20
-13.52 -17.37 -19.29 -19.28
-19.28 -19.29 -17.37 -13.52
-21.20 -19.28 -13.52   0.00

Iterate step: %d 61
  0.00 -13.54 -19.32 -21.24
-13.54 -17.40 -19.33 -19.32
-19.32 -19.33 -17.40 -13.54
-21.24 -19.32 -13.54   0.00

Iterate step: %d 62
  0.00 -13.57 -19.36 -21.28
-13.57 -17.43 -19.36 -19.36
-19.36 -19.36 -17.43 -13.57
-21.28 -19.36 -13.57   0.00

Iterate step: %d 63
  0.00 -13.59 -19.39 -21.32
-13.59 -17.46 -19.40 -19.39
-19.39 -19.40 -17.46 -13.59
-21.32 -19.39 -13.59   0.00

Iterate step: %d 64
  0.00 -13.61 -19.42 -21.36
-13.61 -17.49 -19.43 -19.42
-19.42 -19.43 -17.49 -13.61
-21.36 -19.42 -13.61   0.00

Iterate step: %d 65
  0.00 -13.63 -19.45 -21.39
-13.63 -17.52 -19.46 -19.45
-19.45 -19.46 -17.52 -13.63
-21.39 -19.45 -13.63   0.00

Iterate step: %d 66
  0.00 -13.65 -19.48 -21.42
-13.65 -17.54 -19.49 -19.48
-19.48 -19.49 -17.54 -13.65
-21.42 -19.48 -13.65   0.00

Iterate step: %d 67
  0.00 -13.67 -19.51 -21.45
-13.67 -17.57 -19.51 -19.51
-19.51 -19.51 -17.57 -13.67
-21.45 -19.51 -13.67   0.00

Iterate step: %d 68
  0.00 -13.69 -19.54 -21.48
-13.69 -17.59 -19.54 -19.54
-19.54 -19.54 -17.59 -13.69
-21.48 -19.54 -13.69   0.00

Iterate step: %d 69
  0.00 -13.70 -19.56 -21.51
-13.70 -17.61 -19.56 -19.56
-19.56 -19.56 -17.61 -13.70
-21.51 -19.56 -13.70   0.00

Iterate step: %d 70
  0.00 -13.72 -19.58 -21.54
-13.72 -17.63 -19.59 -19.58
-19.58 -19.59 -17.63 -13.72
-21.54 -19.58 -13.72   0.00

Iterate step: %d 71
  0.00 -13.73 -19.61 -21.56
-13.73 -17.65 -19.61 -19.61
-19.61 -19.61 -17.65 -13.73
-21.56 -19.61 -13.73   0.00

Iterate step: %d 72
  0.00 -13.75 -19.63 -21.58
-13.75 -17.67 -19.63 -19.63
-19.63 -19.63 -17.67 -13.75
-21.58 -19.63 -13.75   0.00

Iterate step: %d 73
  0.00 -13.76 -19.65 -21.61
-13.76 -17.69 -19.65 -19.65
-19.65 -19.65 -17.69 -13.76
-21.61 -19.65 -13.76   0.00

Iterate step: %d 74
  0.00 -13.77 -19.67 -21.63
-13.77 -17.71 -19.67 -19.67
-19.67 -19.67 -17.71 -13.77
-21.63 -19.67 -13.77   0.00

Iterate step: %d 75
  0.00 -13.79 -19.68 -21.65
-13.79 -17.72 -19.69 -19.68
-19.68 -19.69 -17.72 -13.79
-21.65 -19.68 -13.79   0.00

Iterate step: %d 76
  0.00 -13.80 -19.70 -21.67
-13.80 -17.74 -19.70 -19.70
-19.70 -19.70 -17.74 -13.80
-21.67 -19.70 -13.80   0.00

Iterate step: %d 77
  0.00 -13.81 -19.72 -21.68
-13.81 -17.75 -19.72 -19.72
-19.72 -19.72 -17.75 -13.81
-21.68 -19.72 -13.81   0.00

Iterate step: %d 78
  0.00 -13.82 -19.73 -21.70
-13.82 -17.76 -19.73 -19.73
-19.73 -19.73 -17.76 -13.82
-21.70 -19.73 -13.82   0.00

Iterate step: %d 79
  0.00 -13.83 -19.75 -21.72
-13.83 -17.78 -19.75 -19.75
-19.75 -19.75 -17.78 -13.83
-21.72 -19.75 -13.83   0.00

Iterate step: %d 80
  0.00 -13.84 -19.76 -21.73
-13.84 -17.79 -19.76 -19.76
-19.76 -19.76 -17.79 -13.84
-21.73 -19.76 -13.84   0.00

Iterate step: %d 81
  0.00 -13.85 -19.77 -21.75
-13.85 -17.80 -19.77 -19.77
-19.77 -19.77 -17.80 -13.85
-21.75 -19.77 -13.85   0.00

Iterate step: %d 82
  0.00 -13.85 -19.78 -21.76
-13.85 -17.81 -19.79 -19.78
-19.78 -19.79 -17.81 -13.85
-21.76 -19.78 -13.85   0.00

Iterate step: %d 83
  0.00 -13.86 -19.80 -21.77
-13.86 -17.82 -19.80 -19.80
-19.80 -19.80 -17.82 -13.86
-21.77 -19.80 -13.86   0.00

Iterate step: %d 84
  0.00 -13.87 -19.81 -21.78
-13.87 -17.83 -19.81 -19.81
-19.81 -19.81 -17.83 -13.87
-21.78 -19.81 -13.87   0.00

Iterate step: %d 85
  0.00 -13.88 -19.82 -21.80
-13.88 -17.84 -19.82 -19.82
-19.82 -19.82 -17.84 -13.88
-21.80 -19.82 -13.88   0.00

Iterate step: %d 86
  0.00 -13.88 -19.83 -21.81
-13.88 -17.85 -19.83 -19.83
-19.83 -19.83 -17.85 -13.88
-21.81 -19.83 -13.88   0.00

Iterate step: %d 87
  0.00 -13.89 -19.84 -21.82
-13.89 -17.86 -19.84 -19.84
-19.84 -19.84 -17.86 -13.89
-21.82 -19.84 -13.89   0.00

Iterate step: %d 88
  0.00 -13.90 -19.84 -21.83
-13.90 -17.86 -19.85 -19.84
-19.84 -19.85 -17.86 -13.90
-21.83 -19.84 -13.90   0.00

Iterate step: %d 89
  0.00 -13.90 -19.85 -21.84
-13.90 -17.87 -19.85 -19.85
-19.85 -19.85 -17.87 -13.90
-21.84 -19.85 -13.90   0.00

Iterate step: %d 90
  0.00 -13.91 -19.86 -21.84
-13.91 -17.88 -19.86 -19.86
-19.86 -19.86 -17.88 -13.91
-21.84 -19.86 -13.91   0.00

Iterate step: %d 91
  0.00 -13.91 -19.87 -21.85
-13.91 -17.88 -19.87 -19.87
-19.87 -19.87 -17.88 -13.91
-21.85 -19.87 -13.91   0.00

Iterate step: %d 92
  0.00 -13.92 -19.88 -21.86
-13.92 -17.89 -19.88 -19.88
-19.88 -19.88 -17.89 -13.92
-21.86 -19.88 -13.92   0.00

Iterate step: %d 93
  0.00 -13.92 -19.88 -21.87
-13.92 -17.90 -19.88 -19.88
-19.88 -19.88 -17.90 -13.92
-21.87 -19.88 -13.92   0.00

Iterate step: %d 94
  0.00 -13.92 -19.89 -21.87
-13.92 -17.90 -19.89 -19.89
-19.89 -19.89 -17.90 -13.92
-21.87 -19.89 -13.92   0.00

Iterate step: %d 95
  0.00 -13.93 -19.89 -21.88
-13.93 -17.91 -19.89 -19.89
-19.89 -19.89 -17.91 -13.93
-21.88 -19.89 -13.93   0.00

Iterate step: %d 96
  0.00 -13.93 -19.90 -21.89
-13.93 -17.91 -19.90 -19.90
-19.90 -19.90 -17.91 -13.93
-21.89 -19.90 -13.93   0.00

Iterate step: %d 97
  0.00 -13.94 -19.91 -21.89
-13.94 -17.92 -19.91 -19.91
-19.91 -19.91 -17.92 -13.94
-21.89 -19.91 -13.94   0.00

Iterate step: %d 98
  0.00 -13.94 -19.91 -21.90
-13.94 -17.92 -19.91 -19.91
-19.91 -19.91 -17.92 -13.94
-21.90 -19.91 -13.94   0.00

Iterate step: %d 99
  0.00 -13.94 -19.91 -21.90
-13.94 -17.93 -19.92 -19.91
-19.91 -19.92 -17.93 -13.94
-21.90 -19.91 -13.94   0.00

Iterate step: %d 100
  0.00 -13.95 -19.92 -21.91
-13.95 -17.93 -19.92 -19.92
-19.92 -19.92 -17.93 -13.95
-21.91 -19.92 -13.95   0.00

Iterate step: %d 101
  0.00 -13.95 -19.92 -21.91
-13.95 -17.93 -19.92 -19.92
-19.92 -19.92 -17.93 -13.95
-21.91 -19.92 -13.95   0.00

Iterate step: %d 102
  0.00 -13.95 -19.93 -21.92
-13.95 -17.94 -19.93 -19.93
-19.93 -19.93 -17.94 -13.95
-21.92 -19.93 -13.95   0.00

Iterate step: %d 103
  0.00 -13.95 -19.93 -21.92
-13.95 -17.94 -19.93 -19.93
-19.93 -19.93 -17.94 -13.95
-21.92 -19.93 -13.95   0.00

Iterate step: %d 104
  0.00 -13.96 -19.94 -21.93
-13.96 -17.94 -19.94 -19.94
-19.94 -19.94 -17.94 -13.96
-21.93 -19.94 -13.96   0.00

Iterate step: %d 105
  0.00 -13.96 -19.94 -21.93
-13.96 -17.95 -19.94 -19.94
-19.94 -19.94 -17.95 -13.96
-21.93 -19.94 -13.96   0.00

Iterate step: %d 106
  0.00 -13.96 -19.94 -21.94
-13.96 -17.95 -19.94 -19.94
-19.94 -19.94 -17.95 -13.96
-21.94 -19.94 -13.96   0.00

Iterate step: %d 107
  0.00 -13.96 -19.95 -21.94
-13.96 -17.95 -19.95 -19.95
-19.95 -19.95 -17.95 -13.96
-21.94 -19.95 -13.96   0.00

Iterate step: %d 108
  0.00 -13.96 -19.95 -21.94
-13.96 -17.95 -19.95 -19.95
-19.95 -19.95 -17.95 -13.96
-21.94 -19.95 -13.96   0.00

Iterate step: %d 109
  0.00 -13.97 -19.95 -21.94
-13.97 -17.96 -19.95 -19.95
-19.95 -19.95 -17.96 -13.97
-21.94 -19.95 -13.97   0.00

Iterate step: %d 110
  0.00 -13.97 -19.95 -21.95
-13.97 -17.96 -19.95 -19.95
-19.95 -19.95 -17.96 -13.97
-21.95 -19.95 -13.97   0.00

Iterate step: %d 111
  0.00 -13.97 -19.96 -21.95
-13.97 -17.96 -19.96 -19.96
-19.96 -19.96 -17.96 -13.97
-21.95 -19.96 -13.97   0.00

Iterate step: %d 112
  0.00 -13.97 -19.96 -21.95
-13.97 -17.96 -19.96 -19.96
-19.96 -19.96 -17.96 -13.97
-21.95 -19.96 -13.97   0.00

Iterate step: %d 113
  0.00 -13.97 -19.96 -21.96
-13.97 -17.97 -19.96 -19.96
-19.96 -19.96 -17.97 -13.97
-21.96 -19.96 -13.97   0.00

Iterate step: %d 114
  0.00 -13.97 -19.96 -21.96
-13.97 -17.97 -19.96 -19.96
-19.96 -19.96 -17.97 -13.97
-21.96 -19.96 -13.97   0.00

Iterate step: %d 115
  0.00 -13.98 -19.96 -21.96
-13.98 -17.97 -19.96 -19.96
-19.96 -19.96 -17.97 -13.98
-21.96 -19.96 -13.98   0.00

Iterate step: %d 116
  0.00 -13.98 -19.97 -21.96
-13.98 -17.97 -19.97 -19.97
-19.97 -19.97 -17.97 -13.98
-21.96 -19.97 -13.98   0.00

Iterate step: %d 117
  0.00 -13.98 -19.97 -21.96
-13.98 -17.97 -19.97 -19.97
-19.97 -19.97 -17.97 -13.98
-21.96 -19.97 -13.98   0.00

Iterate step: %d 118
  0.00 -13.98 -19.97 -21.97
-13.98 -17.97 -19.97 -19.97
-19.97 -19.97 -17.97 -13.98
-21.97 -19.97 -13.98   0.00

Iterate step: %d 119
  0.00 -13.98 -19.97 -21.97
-13.98 -17.97 -19.97 -19.97
-19.97 -19.97 -17.97 -13.98
-21.97 -19.97 -13.98   0.00

Iterate step: %d 120
  0.00 -13.98 -19.97 -21.97
-13.98 -17.98 -19.97 -19.97
-19.97 -19.97 -17.98 -13.98
-21.97 -19.97 -13.98   0.00

Iterate step: %d 121
  0.00 -13.98 -19.97 -21.97
-13.98 -17.98 -19.97 -19.97
-19.97 -19.97 -17.98 -13.98
-21.97 -19.97 -13.98   0.00

Iterate step: %d 122
  0.00 -13.98 -19.98 -21.97
-13.98 -17.98 -19.98 -19.98
-19.98 -19.98 -17.98 -13.98
-21.97 -19.98 -13.98   0.00

Iterate step: %d 123
  0.00 -13.98 -19.98 -21.97
-13.98 -17.98 -19.98 -19.98
-19.98 -19.98 -17.98 -13.98
-21.97 -19.98 -13.98   0.00

Iterate step: %d 124
  0.00 -13.99 -19.98 -21.98
-13.99 -17.98 -19.98 -19.98
-19.98 -19.98 -17.98 -13.99
-21.98 -19.98 -13.99   0.00

Iterate step: %d 125
  0.00 -13.99 -19.98 -21.98
-13.99 -17.98 -19.98 -19.98
-19.98 -19.98 -17.98 -13.99
-21.98 -19.98 -13.99   0.00

Iterate step: %d 126
  0.00 -13.99 -19.98 -21.98
-13.99 -17.98 -19.98 -19.98
-19.98 -19.98 -17.98 -13.99
-21.98 -19.98 -13.99   0.00

Iterate step: %d 127
  0.00 -13.99 -19.98 -21.98
-13.99 -17.98 -19.98 -19.98
-19.98 -19.98 -17.98 -13.99
-21.98 -19.98 -13.99   0.00

Iterate step: %d 128
  0.00 -13.99 -19.98 -21.98
-13.99 -17.98 -19.98 -19.98
-19.98 -19.98 -17.98 -13.99
-21.98 -19.98 -13.99   0.00

Iterate step: %d 129
  0.00 -13.99 -19.98 -21.98
-13.99 -17.99 -19.98 -19.98
-19.98 -19.98 -17.99 -13.99
-21.98 -19.98 -13.99   0.00

Iterate step: %d 130
  0.00 -13.99 -19.98 -21.98
-13.99 -17.99 -19.98 -19.98
-19.98 -19.98 -17.99 -13.99
-21.98 -19.98 -13.99   0.00

Iterate step: %d 131
  0.00 -13.99 -19.99 -21.98
-13.99 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -13.99
-21.98 -19.99 -13.99   0.00

Iterate step: %d 132
  0.00 -13.99 -19.99 -21.98
-13.99 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -13.99
-21.98 -19.99 -13.99   0.00

Iterate step: %d 133
  0.00 -13.99 -19.99 -21.99
-13.99 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -13.99
-21.99 -19.99 -13.99   0.00

Iterate step: %d 134
  0.00 -13.99 -19.99 -21.99
-13.99 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -13.99
-21.99 -19.99 -13.99   0.00

Iterate step: %d 135
  0.00 -13.99 -19.99 -21.99
-13.99 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -13.99
-21.99 -19.99 -13.99   0.00

Iterate step: %d 136
  0.00 -13.99 -19.99 -21.99
-13.99 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -13.99
-21.99 -19.99 -13.99   0.00

Iterate step: %d 137
  0.00 -13.99 -19.99 -21.99
-13.99 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -13.99
-21.99 -19.99 -13.99   0.00

Iterate step: %d 138
  0.00 -13.99 -19.99 -21.99
-13.99 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -13.99
-21.99 -19.99 -13.99   0.00

Iterate step: %d 139
  0.00 -13.99 -19.99 -21.99
-13.99 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -13.99
-21.99 -19.99 -13.99   0.00

Iterate step: %d 140
  0.00 -13.99 -19.99 -21.99
-13.99 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -13.99
-21.99 -19.99 -13.99   0.00

Iterate step: %d 141
  0.00 -13.99 -19.99 -21.99
-13.99 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -13.99
-21.99 -19.99 -13.99   0.00

Iterate step: %d 142
  0.00 -13.99 -19.99 -21.99
-13.99 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -13.99
-21.99 -19.99 -13.99   0.00

Iterate step: %d 143
  0.00 -13.99 -19.99 -21.99
-13.99 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -13.99
-21.99 -19.99 -13.99   0.00

Iterate step: %d 144
  0.00 -14.00 -19.99 -21.99
-14.00 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -14.00
-21.99 -19.99 -14.00   0.00

Iterate step: %d 145
  0.00 -14.00 -19.99 -21.99
-14.00 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -14.00
-21.99 -19.99 -14.00   0.00

Iterate step: %d 146
  0.00 -14.00 -19.99 -21.99
-14.00 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -14.00
-21.99 -19.99 -14.00   0.00

Iterate step: %d 147
  0.00 -14.00 -19.99 -21.99
-14.00 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -14.00
-21.99 -19.99 -14.00   0.00

Iterate step: %d 148
  0.00 -14.00 -19.99 -21.99
-14.00 -17.99 -19.99 -19.99
-19.99 -19.99 -17.99 -14.00
-21.99 -19.99 -14.00   0.00

Iterate step: %d 149
  0.00 -14.00 -19.99 -21.99
-14.00 -18.00 -19.99 -19.99
-19.99 -19.99 -18.00 -14.00
-21.99 -19.99 -14.00   0.00

Iterate step: %d 150
  0.00 -14.00 -19.99 -21.99
-14.00 -18.00 -19.99 -19.99
-19.99 -19.99 -18.00 -14.00
-21.99 -19.99 -14.00   0.00

Iterate step: %d 151
  0.00 -14.00 -20.00 -21.99
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-21.99 -20.00 -14.00   0.00

Iterate step: %d 152
  0.00 -14.00 -20.00 -21.99
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-21.99 -20.00 -14.00   0.00

Iterate step: %d 153
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 154
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 155
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 156
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 157
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 158
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 159
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 160
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 161
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 162
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 163
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 164
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 165
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 166
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 167
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 168
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 169
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 170
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 171
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 172
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 173
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 174
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 175
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 176
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 177
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 178
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 179
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 180
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 181
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 182
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 183
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 184
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 185
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 186
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 187
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 188
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 189
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 190
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 191
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 192
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 193
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 194
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 195
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 196
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 197
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 198
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 199
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

Iterate step: %d 200
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00

# The finally results
  0.00 -14.00 -20.00 -22.00
-14.00 -18.00 -20.00 -20.00
-20.00 -20.00 -18.00 -14.00
-22.00 -20.00 -14.00   0.00
"""